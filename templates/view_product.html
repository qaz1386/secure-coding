{% extends "base.html" %}
{% block title %}ìƒí’ˆ ìƒì„¸ë³´ê¸°{% endblock %}
{% block content %}
<h2>{{ product.title|e }}</h2>
<p>{{ product.description|e }}</p>
<p>ê°€ê²©: {{ product.price|e }}</p>
<p>íŒë§¤ì: {{ seller.username|e if seller else 'ì•Œ ìˆ˜ ì—†ìŒ' }}</p>

{% if seller.bank_account %}
  <h4>íŒë§¤ì ì…ê¸ˆ ê³„ì¢Œ:</h4>
  <p>{{ seller.bank_account|e }}</p>
{% else %}
  <p>íŒë§¤ì ê³„ì¢Œ ì •ë³´ê°€ ë“±ë¡ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
{% endif %}

{% if user.id == product.seller_id or session.get('is_admin') == 1 %}
  <a href="{{ url_for('edit_product', product_id=product.id) }}">âœï¸ ìˆ˜ì •</a>
  <form method="post" action="{{ url_for('delete_product', product_id=product.id) }}" style="display:inline;">
    <button type="submit" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ğŸ—‘ ì‚­ì œ</button>
  </form>
{% endif %}

{% if product.status == 'íŒë§¤ì¤‘' and user.id != product.seller_id %}
  <form method="post" action="{{ url_for('start_transaction', product_id=product.id) }}">
    <button type="submit">ğŸ’¬ ê±°ë˜ ì‹œì‘</button>
  </form>

{% elif product.status == 'ê±°ë˜ì¤‘' %}
  {% if user.id == product.seller_id %}
    <p>ì…ê¸ˆì´ ì™„ë£Œë˜ì—ˆìœ¼ë©´ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
    <form method="post" action="{{ url_for('confirm_payment', product_id=product.id) }}">
      <button type="submit">âœ… ì…ê¸ˆ í™•ì¸</button>
    </form>
  {% else %}
    {% if seller.bank_account %}
      <p><strong>ì…ê¸ˆ ê³„ì¢Œ:</strong> {{ seller.bank_account|e }}</p>
    {% else %}
      <p>íŒë§¤ì ê³„ì¢Œ ì •ë³´ê°€ ë“±ë¡ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
    {% endif %}
  {% endif %}

{% elif product.status == 'ê±°ë˜ì™„ë£Œ' %}
  <p><strong>âœ… ì´ ìƒí’ˆì€ ê±°ë˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</strong></p>
{% endif %}
{% endblock %}
